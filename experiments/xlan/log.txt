[INFO: 2020-10-15 10:20:45,062] Training with config:
[INFO: 2020-10-15 10:20:45,065] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-10-15 10:20:45,065] Setting up dataset ...
[INFO: 2020-10-15 10:20:46,067] Finish setting up dataset ...
[INFO: 2020-10-15 10:20:58,438] Iteration 0 (DataTime/BatchTime: 0.591/1.42) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-10-15 10:20:58,439]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-10-15 10:21:02,730] Iteration 20 (DataTime/BatchTime: 0.000257/0.215) losses = 9.1838, lr = [6.875e-07]
[INFO: 2020-10-15 10:21:02,731]   CrossEntropy Loss = 9.183382987976074
[INFO: 2020-10-15 10:21:06,951] Iteration 40 (DataTime/BatchTime: 0.000172/0.211) losses = 9.1609, lr = [1.3125e-06]
[INFO: 2020-10-15 10:21:06,951]   CrossEntropy Loss = 9.138938903808594
[INFO: 2020-10-15 10:21:11,580] Iteration 60 (DataTime/BatchTime: 0.000189/0.231) losses = 9.119, lr = [1.9375e-06]
[INFO: 2020-10-15 10:21:11,580]   CrossEntropy Loss = 9.089426040649414
[INFO: 2020-10-15 10:21:16,107] Iteration 80 (DataTime/BatchTime: 0.0002/0.226) losses = 9.0532, lr = [2.5625e-06]
[INFO: 2020-10-15 10:21:16,107]   CrossEntropy Loss = 9.029867172241211
[INFO: 2020-10-15 10:21:20,494] Iteration 100 (DataTime/BatchTime: 0.00024/0.219) losses = 8.9527, lr = [3.1875e-06]
[INFO: 2020-10-15 10:21:20,494]   CrossEntropy Loss = 8.914053916931152
[INFO: 2020-10-15 10:21:25,063] Iteration 120 (DataTime/BatchTime: 0.00022/0.228) losses = 8.7938, lr = [3.8125e-06]
[INFO: 2020-10-15 10:21:25,063]   CrossEntropy Loss = 8.67493724822998
[INFO: 2020-10-15 10:21:29,385] Iteration 140 (DataTime/BatchTime: 0.000394/0.216) losses = 8.5945, lr = [4.4374999999999994e-06]
[INFO: 2020-10-15 10:21:29,385]   CrossEntropy Loss = 8.479341506958008
[INFO: 2020-10-15 10:21:33,641] Iteration 160 (DataTime/BatchTime: 0.000397/0.213) losses = 8.3102, lr = [5.062499999999999e-06]
[INFO: 2020-10-15 10:21:33,641]   CrossEntropy Loss = 8.008025169372559
[INFO: 2020-10-15 10:21:38,205] Iteration 180 (DataTime/BatchTime: 0.000476/0.228) losses = 7.9749, lr = [5.687499999999999e-06]
[INFO: 2020-10-15 10:21:38,206]   CrossEntropy Loss = 7.837101459503174
[INFO: 2020-10-15 10:21:42,658] Iteration 200 (DataTime/BatchTime: 0.000318/0.223) losses = 7.5362, lr = [6.3125e-06]
[INFO: 2020-10-15 10:21:42,658]   CrossEntropy Loss = 7.28774881362915
[INFO: 2020-10-15 10:21:47,158] Iteration 220 (DataTime/BatchTime: 0.00053/0.225) losses = 7.1811, lr = [6.9375e-06]
[INFO: 2020-10-15 10:21:47,159]   CrossEntropy Loss = 7.001515865325928
[INFO: 2020-10-15 10:21:51,390] Iteration 240 (DataTime/BatchTime: 0.000429/0.212) losses = 6.8507, lr = [7.5625e-06]
[INFO: 2020-10-15 10:21:51,390]   CrossEntropy Loss = 6.768974304199219
[INFO: 2020-10-15 10:21:55,417] Iteration 260 (DataTime/BatchTime: 0.000209/0.201) losses = 6.5499, lr = [8.187499999999999e-06]
[INFO: 2020-10-15 10:21:55,417]   CrossEntropy Loss = 6.3633575439453125
[INFO: 2020-10-15 10:21:59,364] Iteration 280 (DataTime/BatchTime: 0.000166/0.197) losses = 6.3596, lr = [8.812499999999999e-06]
[INFO: 2020-10-15 10:21:59,364]   CrossEntropy Loss = 6.267822265625
[INFO: 2020-10-15 10:22:03,554] Iteration 300 (DataTime/BatchTime: 0.000594/0.21) losses = 6.1431, lr = [9.437499999999999e-06]
[INFO: 2020-10-15 10:22:03,554]   CrossEntropy Loss = 5.993138313293457
[INFO: 2020-10-15 10:22:07,870] Iteration 320 (DataTime/BatchTime: 0.000762/0.216) losses = 6.03, lr = [1.0062499999999999e-05]
[INFO: 2020-10-15 10:22:07,870]   CrossEntropy Loss = 6.074604034423828
[INFO: 2020-10-15 10:22:12,064] Iteration 340 (DataTime/BatchTime: 0.000391/0.21) losses = 5.8876, lr = [1.0687499999999999e-05]
[INFO: 2020-10-15 10:22:12,064]   CrossEntropy Loss = 5.616968631744385
[INFO: 2020-10-15 10:22:16,198] Iteration 360 (DataTime/BatchTime: 0.000376/0.207) losses = 5.7996, lr = [1.1312499999999999e-05]
[INFO: 2020-10-15 10:22:16,198]   CrossEntropy Loss = 5.7053446769714355
[INFO: 2020-10-15 10:22:20,324] Iteration 380 (DataTime/BatchTime: 0.000372/0.206) losses = 5.6569, lr = [1.1937499999999999e-05]
[INFO: 2020-10-15 10:22:20,324]   CrossEntropy Loss = 5.783157825469971
[INFO: 2020-10-15 10:22:24,557] Iteration 400 (DataTime/BatchTime: 0.000563/0.212) losses = 5.586, lr = [1.2562499999999999e-05]
[INFO: 2020-10-15 10:22:24,557]   CrossEntropy Loss = 5.787149429321289
[INFO: 2020-10-15 10:22:29,592] Iteration 420 (DataTime/BatchTime: 0.000584/0.252) losses = 5.5067, lr = [1.3187499999999999e-05]
[INFO: 2020-10-15 10:22:29,593]   CrossEntropy Loss = 5.428131580352783
[INFO: 2020-10-15 10:22:35,072] Iteration 440 (DataTime/BatchTime: 0.000396/0.274) losses = 5.4288, lr = [1.3812499999999999e-05]
[INFO: 2020-10-15 10:22:35,072]   CrossEntropy Loss = 5.468392848968506
[INFO: 2020-10-15 10:22:40,291] Iteration 460 (DataTime/BatchTime: 0.00034/0.261) losses = 5.3614, lr = [1.4437499999999999e-05]
[INFO: 2020-10-15 10:22:40,291]   CrossEntropy Loss = 5.287857532501221
[INFO: 2020-10-15 10:22:45,005] Iteration 480 (DataTime/BatchTime: 0.000675/0.236) losses = 5.2844, lr = [1.5062499999999999e-05]
[INFO: 2020-10-15 10:22:45,005]   CrossEntropy Loss = 5.3808417320251465
[INFO: 2020-10-15 10:22:49,905] Iteration 500 (DataTime/BatchTime: 0.000494/0.245) losses = 5.2995, lr = [1.56875e-05]
[INFO: 2020-10-15 10:22:49,906]   CrossEntropy Loss = 5.213744163513184
[INFO: 2020-10-15 10:22:55,099] Iteration 520 (DataTime/BatchTime: 0.000283/0.26) losses = 5.2024, lr = [1.63125e-05]
[INFO: 2020-10-15 10:22:55,099]   CrossEntropy Loss = 5.2278971672058105
[INFO: 2020-11-11 11:00:57,529] Training with config:
[INFO: 2020-11-11 11:00:57,551] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:00:57,552] Setting up dataset ...
[INFO: 2020-11-11 11:01:14,201] Finish setting up dataset ...
[INFO: 2020-11-11 11:01:14,203] Loading img info
[INFO: 2020-11-11 11:01:49,461] Training with config:
[INFO: 2020-11-11 11:01:49,465] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:01:49,466] Setting up dataset ...
[INFO: 2020-11-11 11:01:50,506] Finish setting up dataset ...
[INFO: 2020-11-11 11:01:50,507] Loading img info
[INFO: 2020-11-11 11:02:23,123] Training with config:
[INFO: 2020-11-11 11:02:23,127] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:02:23,128] Setting up dataset ...
[INFO: 2020-11-11 11:02:24,140] Finish setting up dataset ...
[INFO: 2020-11-11 11:02:24,141] Loading img info
[INFO: 2020-11-11 11:02:40,905] Training with config:
[INFO: 2020-11-11 11:02:40,908] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:02:40,909] Setting up dataset ...
[INFO: 2020-11-11 11:02:41,927] Finish setting up dataset ...
[INFO: 2020-11-11 11:02:41,928] Loading img info
[INFO: 2020-11-11 11:03:16,635] Training with config:
[INFO: 2020-11-11 11:03:16,639] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:03:16,640] Setting up dataset ...
[INFO: 2020-11-11 11:03:17,638] Finish setting up dataset ...
[INFO: 2020-11-11 11:03:17,639] Loading img info
[INFO: 2020-11-11 11:06:14,316] Training with config:
[INFO: 2020-11-11 11:06:14,320] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:06:14,321] Setting up dataset ...
[INFO: 2020-11-11 11:06:15,350] Finish setting up dataset ...
[INFO: 2020-11-11 11:06:15,351] Loading img info
[INFO: 2020-11-11 11:08:48,525] Training with config:
[INFO: 2020-11-11 11:08:48,529] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:08:48,529] Setting up dataset ...
[INFO: 2020-11-11 11:08:49,641] Finish setting up dataset ...
[INFO: 2020-11-11 11:08:49,642] Loading img info
[INFO: 2020-11-11 11:09:41,971] Training with config:
[INFO: 2020-11-11 11:09:41,975] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:09:41,975] Setting up dataset ...
[INFO: 2020-11-11 11:09:42,981] Finish setting up dataset ...
[INFO: 2020-11-11 11:09:42,982] Loading img info
[INFO: 2020-11-11 11:11:09,371] Training with config:
[INFO: 2020-11-11 11:11:09,375] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:11:09,376] Setting up dataset ...
[INFO: 2020-11-11 11:11:10,625] Finish setting up dataset ...
[INFO: 2020-11-11 11:11:10,626] Loading img info
[INFO: 2020-11-11 11:12:28,777] Training with config:
[INFO: 2020-11-11 11:12:28,780] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:12:28,781] Setting up dataset ...
[INFO: 2020-11-11 11:12:29,810] Finish setting up dataset ...
[INFO: 2020-11-11 11:12:29,812] Loading img info
[INFO: 2020-11-11 11:12:52,676] Iteration 0 (DataTime/BatchTime: 0.571/1.32) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 11:12:52,677]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 11:12:57,022] Iteration 20 (DataTime/BatchTime: 0.0204/0.237) losses = 9.1838, lr = [6.875e-07]
[INFO: 2020-11-11 11:12:57,023]   CrossEntropy Loss = 9.183382987976074
[INFO: 2020-11-11 11:13:01,087] Iteration 40 (DataTime/BatchTime: 0.000318/0.203) losses = 9.1609, lr = [1.3125e-06]
[INFO: 2020-11-11 11:13:01,087]   CrossEntropy Loss = 9.138938903808594
[INFO: 2020-11-11 11:13:05,370] Iteration 60 (DataTime/BatchTime: 0.000344/0.214) losses = 9.119, lr = [1.9375e-06]
[INFO: 2020-11-11 11:13:05,370]   CrossEntropy Loss = 9.089426040649414
[INFO: 2020-11-11 11:13:09,675] Iteration 80 (DataTime/BatchTime: 0.000646/0.215) losses = 9.0532, lr = [2.5625e-06]
[INFO: 2020-11-11 11:13:09,676]   CrossEntropy Loss = 9.029867172241211
[INFO: 2020-11-11 11:13:13,865] Iteration 100 (DataTime/BatchTime: 0.000556/0.209) losses = 8.9527, lr = [3.1875e-06]
[INFO: 2020-11-11 11:13:13,865]   CrossEntropy Loss = 8.914053916931152
[INFO: 2020-11-11 11:13:18,106] Iteration 120 (DataTime/BatchTime: 0.000486/0.212) losses = 8.7938, lr = [3.8125e-06]
[INFO: 2020-11-11 11:13:18,106]   CrossEntropy Loss = 8.67493724822998
[INFO: 2020-11-11 11:13:22,068] Iteration 140 (DataTime/BatchTime: 0.000284/0.198) losses = 8.5945, lr = [4.4374999999999994e-06]
[INFO: 2020-11-11 11:13:22,069]   CrossEntropy Loss = 8.479341506958008
[INFO: 2020-11-11 11:13:26,320] Iteration 160 (DataTime/BatchTime: 0.000422/0.213) losses = 8.3102, lr = [5.062499999999999e-06]
[INFO: 2020-11-11 11:13:26,320]   CrossEntropy Loss = 8.008025169372559
[INFO: 2020-11-11 11:13:30,603] Iteration 180 (DataTime/BatchTime: 0.000609/0.214) losses = 7.9749, lr = [5.687499999999999e-06]
[INFO: 2020-11-11 11:13:30,603]   CrossEntropy Loss = 7.837101459503174
[INFO: 2020-11-11 11:13:34,809] Iteration 200 (DataTime/BatchTime: 0.000518/0.21) losses = 7.5362, lr = [6.3125e-06]
[INFO: 2020-11-11 11:13:34,809]   CrossEntropy Loss = 7.28774881362915
[INFO: 2020-11-11 11:13:38,888] Iteration 220 (DataTime/BatchTime: 0.00033/0.204) losses = 7.1811, lr = [6.9375e-06]
[INFO: 2020-11-11 11:13:38,888]   CrossEntropy Loss = 7.001515865325928
[INFO: 2020-11-11 11:13:42,908] Iteration 240 (DataTime/BatchTime: 0.000376/0.201) losses = 6.8507, lr = [7.5625e-06]
[INFO: 2020-11-11 11:13:42,908]   CrossEntropy Loss = 6.768974304199219
[INFO: 2020-11-11 11:13:46,942] Iteration 260 (DataTime/BatchTime: 0.000336/0.202) losses = 6.5499, lr = [8.187499999999999e-06]
[INFO: 2020-11-11 11:13:46,942]   CrossEntropy Loss = 6.3633575439453125
[INFO: 2020-11-11 11:13:50,766] Iteration 280 (DataTime/BatchTime: 0.000245/0.191) losses = 6.3596, lr = [8.812499999999999e-06]
[INFO: 2020-11-11 11:13:50,766]   CrossEntropy Loss = 6.267822265625
[INFO: 2020-11-11 11:13:54,873] Iteration 300 (DataTime/BatchTime: 0.000273/0.205) losses = 6.1431, lr = [9.437499999999999e-06]
[INFO: 2020-11-11 11:13:54,873]   CrossEntropy Loss = 5.993138313293457
[INFO: 2020-11-11 11:13:58,736] Iteration 320 (DataTime/BatchTime: 0.00024/0.193) losses = 6.03, lr = [1.0062499999999999e-05]
[INFO: 2020-11-11 11:13:58,736]   CrossEntropy Loss = 6.074604034423828
[INFO: 2020-11-11 11:14:02,700] Iteration 340 (DataTime/BatchTime: 0.000401/0.198) losses = 5.8876, lr = [1.0687499999999999e-05]
[INFO: 2020-11-11 11:14:02,700]   CrossEntropy Loss = 5.616968631744385
[INFO: 2020-11-11 11:14:06,822] Iteration 360 (DataTime/BatchTime: 0.00025/0.206) losses = 5.7996, lr = [1.1312499999999999e-05]
[INFO: 2020-11-11 11:14:06,823]   CrossEntropy Loss = 5.7053446769714355
[INFO: 2020-11-11 11:14:10,538] Iteration 380 (DataTime/BatchTime: 0.000394/0.186) losses = 5.6569, lr = [1.1937499999999999e-05]
[INFO: 2020-11-11 11:14:10,538]   CrossEntropy Loss = 5.783157825469971
[INFO: 2020-11-11 11:14:14,376] Iteration 400 (DataTime/BatchTime: 0.000347/0.192) losses = 5.586, lr = [1.2562499999999999e-05]
[INFO: 2020-11-11 11:14:14,376]   CrossEntropy Loss = 5.787149429321289
[INFO: 2020-11-11 11:14:18,485] Iteration 420 (DataTime/BatchTime: 0.000408/0.205) losses = 5.5067, lr = [1.3187499999999999e-05]
[INFO: 2020-11-11 11:14:18,485]   CrossEntropy Loss = 5.428131580352783
[INFO: 2020-11-11 11:14:22,693] Iteration 440 (DataTime/BatchTime: 0.000212/0.21) losses = 5.4288, lr = [1.3812499999999999e-05]
[INFO: 2020-11-11 11:14:22,694]   CrossEntropy Loss = 5.468392848968506
[INFO: 2020-11-11 11:14:26,758] Iteration 460 (DataTime/BatchTime: 0.000237/0.203) losses = 5.3614, lr = [1.4437499999999999e-05]
[INFO: 2020-11-11 11:14:26,758]   CrossEntropy Loss = 5.287857532501221
[INFO: 2020-11-11 11:14:31,047] Iteration 480 (DataTime/BatchTime: 0.000541/0.214) losses = 5.2844, lr = [1.5062499999999999e-05]
[INFO: 2020-11-11 11:14:31,047]   CrossEntropy Loss = 5.3808417320251465
[INFO: 2020-11-11 11:14:35,014] Iteration 500 (DataTime/BatchTime: 0.000332/0.198) losses = 5.2995, lr = [1.56875e-05]
[INFO: 2020-11-11 11:14:35,014]   CrossEntropy Loss = 5.213744163513184
[INFO: 2020-11-11 11:14:38,993] Iteration 520 (DataTime/BatchTime: 0.000273/0.199) losses = 5.2024, lr = [1.63125e-05]
[INFO: 2020-11-11 11:14:38,993]   CrossEntropy Loss = 5.2278971672058105
[INFO: 2020-11-11 11:14:43,146] Iteration 540 (DataTime/BatchTime: 0.000357/0.208) losses = 5.1608, lr = [1.69375e-05]
[INFO: 2020-11-11 11:14:43,146]   CrossEntropy Loss = 5.220823764801025
[INFO: 2020-11-11 11:14:47,347] Iteration 560 (DataTime/BatchTime: 0.000312/0.21) losses = 5.0077, lr = [1.75625e-05]
[INFO: 2020-11-11 11:14:47,347]   CrossEntropy Loss = 5.068343162536621
[INFO: 2020-11-11 11:14:51,340] Iteration 580 (DataTime/BatchTime: 0.000354/0.2) losses = 4.9877, lr = [1.8187499999999998e-05]
[INFO: 2020-11-11 11:14:51,341]   CrossEntropy Loss = 4.353769779205322
[INFO: 2020-11-11 11:14:55,279] Iteration 600 (DataTime/BatchTime: 0.000306/0.197) losses = 4.9672, lr = [1.88125e-05]
[INFO: 2020-11-11 11:14:55,280]   CrossEntropy Loss = 5.004019737243652
[INFO: 2020-11-11 11:14:59,396] Iteration 620 (DataTime/BatchTime: 0.000457/0.206) losses = 5.0115, lr = [1.9437499999999998e-05]
[INFO: 2020-11-11 11:14:59,396]   CrossEntropy Loss = 5.125072002410889
[INFO: 2020-11-11 11:15:03,481] Iteration 640 (DataTime/BatchTime: 0.000309/0.204) losses = 4.9954, lr = [2.00625e-05]
[INFO: 2020-11-11 11:15:03,481]   CrossEntropy Loss = 5.108343601226807
[INFO: 2020-11-11 11:15:07,435] Iteration 660 (DataTime/BatchTime: 0.000219/0.198) losses = 4.9225, lr = [2.0687499999999998e-05]
[INFO: 2020-11-11 11:15:07,435]   CrossEntropy Loss = 5.112231254577637
[INFO: 2020-11-11 11:15:11,369] Iteration 680 (DataTime/BatchTime: 0.000219/0.197) losses = 4.8486, lr = [2.13125e-05]
[INFO: 2020-11-11 11:15:11,369]   CrossEntropy Loss = 5.177237510681152
[INFO: 2020-11-11 11:15:15,246] Iteration 700 (DataTime/BatchTime: 0.000273/0.194) losses = 4.7979, lr = [2.1937499999999998e-05]
[INFO: 2020-11-11 11:15:15,246]   CrossEntropy Loss = 4.830672264099121
[INFO: 2020-11-11 11:15:19,293] Iteration 720 (DataTime/BatchTime: 0.000365/0.202) losses = 4.7732, lr = [2.25625e-05]
[INFO: 2020-11-11 11:15:19,293]   CrossEntropy Loss = 4.674663066864014
[INFO: 2020-11-11 11:15:23,041] Iteration 740 (DataTime/BatchTime: 0.000281/0.187) losses = 4.68, lr = [2.3187499999999998e-05]
[INFO: 2020-11-11 11:15:23,042]   CrossEntropy Loss = 4.868653774261475
[INFO: 2020-11-11 11:15:27,041] Iteration 760 (DataTime/BatchTime: 0.000184/0.2) losses = 4.7257, lr = [2.38125e-05]
[INFO: 2020-11-11 11:15:27,041]   CrossEntropy Loss = 4.5352067947387695
[INFO: 2020-11-11 11:15:30,811] Iteration 780 (DataTime/BatchTime: 0.000406/0.189) losses = 4.7251, lr = [2.4437499999999998e-05]
[INFO: 2020-11-11 11:15:30,811]   CrossEntropy Loss = 4.525200366973877
[INFO: 2020-11-11 11:15:34,875] Iteration 800 (DataTime/BatchTime: 0.000386/0.203) losses = 4.6424, lr = [2.50625e-05]
[INFO: 2020-11-11 11:15:34,875]   CrossEntropy Loss = 4.902903079986572
[INFO: 2020-11-11 11:15:38,685] Iteration 820 (DataTime/BatchTime: 0.000455/0.191) losses = 4.6335, lr = [2.5687499999999998e-05]
[INFO: 2020-11-11 11:15:38,686]   CrossEntropy Loss = 4.318552494049072
[INFO: 2020-11-11 11:15:42,807] Iteration 840 (DataTime/BatchTime: 0.000587/0.206) losses = 4.7417, lr = [2.63125e-05]
[INFO: 2020-11-11 11:15:42,808]   CrossEntropy Loss = 4.619589805603027
[INFO: 2020-11-11 11:15:47,056] Iteration 860 (DataTime/BatchTime: 0.000336/0.212) losses = 4.5539, lr = [2.6937499999999997e-05]
[INFO: 2020-11-11 11:15:47,056]   CrossEntropy Loss = 4.275506973266602
[INFO: 2020-11-11 11:15:51,013] Iteration 880 (DataTime/BatchTime: 0.000327/0.198) losses = 4.5495, lr = [2.75625e-05]
[INFO: 2020-11-11 11:15:51,013]   CrossEntropy Loss = 4.409189701080322
[INFO: 2020-11-11 11:15:55,003] Iteration 900 (DataTime/BatchTime: 0.000301/0.199) losses = 4.4669, lr = [2.8187499999999997e-05]
[INFO: 2020-11-11 11:15:55,003]   CrossEntropy Loss = 4.615017414093018
[INFO: 2020-11-11 11:15:59,325] Iteration 920 (DataTime/BatchTime: 0.00051/0.216) losses = 4.5438, lr = [2.88125e-05]
[INFO: 2020-11-11 11:15:59,325]   CrossEntropy Loss = 4.7390241622924805
[INFO: 2020-11-11 11:16:03,239] Iteration 940 (DataTime/BatchTime: 0.000454/0.196) losses = 4.4169, lr = [2.9437499999999997e-05]
[INFO: 2020-11-11 11:16:03,239]   CrossEntropy Loss = 4.3910346031188965
[INFO: 2020-11-11 11:17:03,420] Training with config:
[INFO: 2020-11-11 11:17:03,424] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:17:03,424] Setting up dataset ...
[INFO: 2020-11-11 11:17:04,565] Finish setting up dataset ...
[INFO: 2020-11-11 11:17:04,566] Loading img info
[INFO: 2020-11-11 11:17:27,369] Iteration 0 (DataTime/BatchTime: 0.558/1.2) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 11:17:27,370]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 11:17:31,798] Iteration 20 (DataTime/BatchTime: 0.0145/0.236) losses = 9.1838, lr = [6.875e-07]
[INFO: 2020-11-11 11:17:31,798]   CrossEntropy Loss = 9.183382987976074
[INFO: 2020-11-11 11:17:35,834] Iteration 40 (DataTime/BatchTime: 0.000199/0.202) losses = 9.1609, lr = [1.3125e-06]
[INFO: 2020-11-11 11:17:35,834]   CrossEntropy Loss = 9.138938903808594
[INFO: 2020-11-11 11:17:39,947] Iteration 60 (DataTime/BatchTime: 0.000447/0.206) losses = 9.119, lr = [1.9375e-06]
[INFO: 2020-11-11 11:17:39,948]   CrossEntropy Loss = 9.089426040649414
[INFO: 2020-11-11 11:17:43,868] Iteration 80 (DataTime/BatchTime: 0.000201/0.196) losses = 9.0532, lr = [2.5625e-06]
[INFO: 2020-11-11 11:17:43,869]   CrossEntropy Loss = 9.029867172241211
[INFO: 2020-11-11 11:17:47,645] Iteration 100 (DataTime/BatchTime: 0.000481/0.189) losses = 8.9527, lr = [3.1875e-06]
[INFO: 2020-11-11 11:17:47,645]   CrossEntropy Loss = 8.914053916931152
[INFO: 2020-11-11 11:17:51,838] Iteration 120 (DataTime/BatchTime: 0.000538/0.21) losses = 8.7938, lr = [3.8125e-06]
[INFO: 2020-11-11 11:17:51,839]   CrossEntropy Loss = 8.67493724822998
[INFO: 2020-11-11 11:17:56,129] Iteration 140 (DataTime/BatchTime: 0.000554/0.215) losses = 8.5945, lr = [4.4374999999999994e-06]
[INFO: 2020-11-11 11:17:56,130]   CrossEntropy Loss = 8.479341506958008
[INFO: 2020-11-11 11:18:00,019] Iteration 160 (DataTime/BatchTime: 0.000402/0.194) losses = 8.3102, lr = [5.062499999999999e-06]
[INFO: 2020-11-11 11:18:00,020]   CrossEntropy Loss = 8.008025169372559
[INFO: 2020-11-11 11:18:03,863] Iteration 180 (DataTime/BatchTime: 0.000351/0.192) losses = 7.9749, lr = [5.687499999999999e-06]
[INFO: 2020-11-11 11:18:03,863]   CrossEntropy Loss = 7.837101459503174
[INFO: 2020-11-11 11:18:22,608] Training with config:
[INFO: 2020-11-11 11:18:22,612] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:18:22,612] Setting up dataset ...
[INFO: 2020-11-11 11:18:23,582] Finish setting up dataset ...
[INFO: 2020-11-11 11:18:23,583] Loading img info
[INFO: 2020-11-11 11:18:44,822] Iteration 0 (DataTime/BatchTime: 0.599/1.35) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 11:18:44,823]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 11:18:49,449] Iteration 20 (DataTime/BatchTime: 0.02/0.251) losses = 9.1838, lr = [6.875e-07]
[INFO: 2020-11-11 11:18:49,450]   CrossEntropy Loss = 9.183382987976074
[INFO: 2020-11-11 11:18:53,923] Iteration 40 (DataTime/BatchTime: 0.00066/0.224) losses = 9.1609, lr = [1.3125e-06]
[INFO: 2020-11-11 11:18:53,924]   CrossEntropy Loss = 9.138938903808594
[INFO: 2020-11-11 11:18:57,975] Iteration 60 (DataTime/BatchTime: 0.000295/0.203) losses = 9.119, lr = [1.9375e-06]
[INFO: 2020-11-11 11:18:57,976]   CrossEntropy Loss = 9.089426040649414
[INFO: 2020-11-11 11:19:01,780] Iteration 80 (DataTime/BatchTime: 0.000235/0.19) losses = 9.0532, lr = [2.5625e-06]
[INFO: 2020-11-11 11:19:01,781]   CrossEntropy Loss = 9.029867172241211
[INFO: 2020-11-11 11:19:06,146] Iteration 100 (DataTime/BatchTime: 0.000588/0.211) losses = 8.9527, lr = [3.1875e-06]
[INFO: 2020-11-11 11:19:06,146]   CrossEntropy Loss = 8.914053916931152
[INFO: 2020-11-11 11:19:10,571] Iteration 120 (DataTime/BatchTime: 0.00859/0.229) losses = 8.7938, lr = [3.8125e-06]
[INFO: 2020-11-11 11:19:10,571]   CrossEntropy Loss = 8.67493724822998
[INFO: 2020-11-11 11:19:15,124] Iteration 140 (DataTime/BatchTime: 0.000695/0.228) losses = 8.5945, lr = [4.4374999999999994e-06]
[INFO: 2020-11-11 11:19:15,124]   CrossEntropy Loss = 8.479341506958008
[INFO: 2020-11-11 11:19:19,420] Iteration 160 (DataTime/BatchTime: 0.000542/0.215) losses = 8.3102, lr = [5.062499999999999e-06]
[INFO: 2020-11-11 11:19:19,421]   CrossEntropy Loss = 8.008025169372559
[INFO: 2020-11-11 11:19:23,463] Iteration 180 (DataTime/BatchTime: 0.000397/0.202) losses = 7.9749, lr = [5.687499999999999e-06]
[INFO: 2020-11-11 11:19:23,463]   CrossEntropy Loss = 7.837101459503174
[INFO: 2020-11-11 11:19:27,735] Iteration 200 (DataTime/BatchTime: 0.000285/0.196) losses = 7.5362, lr = [6.3125e-06]
[INFO: 2020-11-11 11:19:27,735]   CrossEntropy Loss = 7.28774881362915
[INFO: 2020-11-11 11:19:31,956] Iteration 220 (DataTime/BatchTime: 0.0173/0.228) losses = 7.1811, lr = [6.9375e-06]
[INFO: 2020-11-11 11:19:31,957]   CrossEntropy Loss = 7.001515865325928
[INFO: 2020-11-11 11:19:35,790] Iteration 240 (DataTime/BatchTime: 0.00023/0.192) losses = 6.8507, lr = [7.5625e-06]
[INFO: 2020-11-11 11:19:35,791]   CrossEntropy Loss = 6.768974304199219
[INFO: 2020-11-11 11:19:39,599] Iteration 260 (DataTime/BatchTime: 0.000223/0.19) losses = 6.5499, lr = [8.187499999999999e-06]
[INFO: 2020-11-11 11:19:39,600]   CrossEntropy Loss = 6.3633575439453125
[INFO: 2020-11-11 11:19:43,322] Iteration 280 (DataTime/BatchTime: 0.000228/0.186) losses = 6.3596, lr = [8.812499999999999e-06]
[INFO: 2020-11-11 11:19:43,323]   CrossEntropy Loss = 6.267822265625
[INFO: 2020-11-11 11:19:47,759] Iteration 300 (DataTime/BatchTime: 0.000441/0.205) losses = 6.1431, lr = [9.437499999999999e-06]
[INFO: 2020-11-11 11:19:47,759]   CrossEntropy Loss = 5.993138313293457
[INFO: 2020-11-11 11:19:52,089] Iteration 320 (DataTime/BatchTime: 0.0171/0.233) losses = 6.03, lr = [1.0062499999999999e-05]
[INFO: 2020-11-11 11:19:52,090]   CrossEntropy Loss = 6.074604034423828
[INFO: 2020-11-11 11:19:56,235] Iteration 340 (DataTime/BatchTime: 0.000757/0.207) losses = 5.8876, lr = [1.0687499999999999e-05]
[INFO: 2020-11-11 11:19:56,236]   CrossEntropy Loss = 5.616968631744385
[INFO: 2020-11-11 11:20:00,654] Iteration 360 (DataTime/BatchTime: 0.000872/0.221) losses = 5.7996, lr = [1.1312499999999999e-05]
[INFO: 2020-11-11 11:20:00,654]   CrossEntropy Loss = 5.7053446769714355
[INFO: 2020-11-11 11:20:05,047] Iteration 380 (DataTime/BatchTime: 0.000648/0.22) losses = 5.6569, lr = [1.1937499999999999e-05]
[INFO: 2020-11-11 11:20:05,048]   CrossEntropy Loss = 5.783157825469971
[INFO: 2020-11-11 11:20:09,263] Iteration 400 (DataTime/BatchTime: 0.000235/0.194) losses = 5.586, lr = [1.2562499999999999e-05]
[INFO: 2020-11-11 11:20:09,264]   CrossEntropy Loss = 5.787149429321289
[INFO: 2020-11-11 11:20:13,389] Iteration 420 (DataTime/BatchTime: 0.0167/0.223) losses = 5.5067, lr = [1.3187499999999999e-05]
[INFO: 2020-11-11 11:20:13,389]   CrossEntropy Loss = 5.428131580352783
[INFO: 2020-11-11 11:34:09,078] Training with config:
[INFO: 2020-11-11 11:34:09,082] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:34:09,083] Setting up dataset ...
[INFO: 2020-11-11 11:34:10,082] Finish setting up dataset ...
[INFO: 2020-11-11 11:34:10,083] Loading img info
[INFO: 2020-11-11 11:34:31,764] Iteration 0 (DataTime/BatchTime: 0.437/1.17) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 11:34:31,765]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 11:42:20,776] Training with config:
[INFO: 2020-11-11 11:42:20,778] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:42:20,779] Setting up dataset ...
[INFO: 2020-11-11 11:42:21,676] Finish setting up dataset ...
[INFO: 2020-11-11 11:42:21,677] Loading img info
[INFO: 2020-11-11 11:45:49,526] Training with config:
[INFO: 2020-11-11 11:45:49,530] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:45:49,530] Setting up dataset ...
[INFO: 2020-11-11 11:45:50,629] Finish setting up dataset ...
[INFO: 2020-11-11 11:45:50,642] Loading img info
[INFO: 2020-11-11 11:46:57,982] Training with config:
[INFO: 2020-11-11 11:46:57,986] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:46:57,987] Setting up dataset ...
[INFO: 2020-11-11 11:46:58,988] Finish setting up dataset ...
[INFO: 2020-11-11 11:46:58,989] Loading img info
[INFO: 2020-11-11 11:47:21,549] Iteration 0 (DataTime/BatchTime: 0.562/1.33) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 11:47:21,550]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 11:58:33,730] Training with config:
[INFO: 2020-11-11 11:58:33,770] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 11:58:33,771] Setting up dataset ...
[INFO: 2020-11-11 11:58:50,547] Finish setting up dataset ...
[INFO: 2020-11-11 11:58:50,549] Loading img info
[INFO: 2020-11-11 12:00:04,832] Iteration 0 (DataTime/BatchTime: 0.85/1.88) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 12:00:04,833]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 12:03:06,288] Training with config:
[INFO: 2020-11-11 12:03:06,291] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 12:03:06,292] Setting up dataset ...
[INFO: 2020-11-11 12:03:30,957] Finish setting up dataset ...
[INFO: 2020-11-11 12:03:30,959] Loading img info
[INFO: 2020-11-11 12:05:30,610] Iteration 0 (DataTime/BatchTime: 2.59/3.39) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 12:05:30,610]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 14:40:41,126] Training with config:
[INFO: 2020-11-11 14:40:41,129] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 14:40:41,130] Setting up dataset ...
[INFO: 2020-11-11 14:40:42,485] Finish setting up dataset ...
[INFO: 2020-11-11 14:40:42,487] Loading img info
[INFO: 2020-11-11 14:41:13,242] Iteration 0 (DataTime/BatchTime: 0.898/2.6) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 14:41:13,243]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 14:43:39,405] Training with config:
[INFO: 2020-11-11 14:43:39,408] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 14:43:39,409] Setting up dataset ...
[INFO: 2020-11-11 14:43:40,797] Finish setting up dataset ...
[INFO: 2020-11-11 14:43:40,799] Loading img info
[INFO: 2020-11-11 14:44:06,954] Iteration 0 (DataTime/BatchTime: 0.586/1.72) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 14:44:06,955]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 16:37:55,732] Training with config:
[INFO: 2020-11-11 16:37:55,734] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 16:37:55,734] Setting up dataset ...
[INFO: 2020-11-11 16:37:56,707] Finish setting up dataset ...
[INFO: 2020-11-11 16:37:56,709] Loading img info
[INFO: 2020-11-11 16:39:54,736] Training with config:
[INFO: 2020-11-11 16:39:54,740] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 16:39:54,740] Setting up dataset ...
[INFO: 2020-11-11 16:39:56,042] Finish setting up dataset ...
[INFO: 2020-11-11 16:39:56,044] Loading img info
[INFO: 2020-11-11 16:40:24,031] Iteration 0 (DataTime/BatchTime: 0.594/1.38) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 16:40:24,031]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 16:42:08,009] Training with config:
[INFO: 2020-11-11 16:42:08,013] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 16:42:08,013] Setting up dataset ...
[INFO: 2020-11-11 16:42:09,103] Finish setting up dataset ...
[INFO: 2020-11-11 16:42:09,105] Loading img info
[INFO: 2020-11-11 16:42:35,132] Iteration 0 (DataTime/BatchTime: 0.546/1.22) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 16:42:35,133]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 16:55:05,339] Training with config:
[INFO: 2020-11-11 16:55:05,343] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 16:55:05,344] Setting up dataset ...
[INFO: 2020-11-11 16:55:06,531] Finish setting up dataset ...
[INFO: 2020-11-11 16:55:06,534] Loading img info
[INFO: 2020-11-11 16:55:38,505] Iteration 0 (DataTime/BatchTime: 0.675/1.42) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 16:55:38,506]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 16:58:58,257] Training with config:
[INFO: 2020-11-11 16:58:58,275] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 16:58:58,275] Setting up dataset ...
[INFO: 2020-11-11 16:58:59,362] Finish setting up dataset ...
[INFO: 2020-11-11 16:58:59,364] Loading img info
[INFO: 2020-11-11 16:59:25,675] Iteration 0 (DataTime/BatchTime: 0.611/1.36) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 16:59:25,675]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-11 17:40:48,378] Training with config:
[INFO: 2020-11-11 17:40:48,429] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-11 17:40:48,429] Setting up dataset ...
[INFO: 2020-11-11 17:40:49,674] Finish setting up dataset ...
[INFO: 2020-11-11 17:40:49,677] Loading img info
[INFO: 2020-11-11 17:41:17,148] Iteration 0 (DataTime/BatchTime: 0.667/1.38) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-11 17:41:17,148]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-12 10:11:29,494] Training with config:
[INFO: 2020-11-12 10:11:29,509] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-11-12 10:11:29,509] Setting up dataset ...
[INFO: 2020-11-12 10:11:30,687] Finish setting up dataset ...
[INFO: 2020-11-12 10:11:30,688] Loading img info
[INFO: 2020-11-12 10:11:58,430] Iteration 0 (DataTime/BatchTime: 1.39/2.15) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-11-12 10:11:58,431]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-11-12 10:17:10,459] ######## Epoch (VAL)1 ########
[INFO: 2020-11-12 10:17:10,459] {'Bleu_1': 0.0011411227706931305, 'Bleu_2': 3.7766812769401884e-12, 'Bleu_3': 5.750585722840446e-15, 'Bleu_4': 2.2829865205908674e-16, 'METEOR': 0.00634593374687614, 'ROUGE_L': 0.0015039993435106047, 'CIDEr': 0.00026476257036869833, 'SPICE': 0.0022359025865183392, 'WMD': 0.024230578732833165}
