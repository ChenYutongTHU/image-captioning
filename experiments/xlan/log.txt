[INFO: 2020-10-15 10:20:45,062] Training with config:
[INFO: 2020-10-15 10:20:45,065] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': './mscoco/sent/coco_train_input.pkl',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 4,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': './mscoco/sent/coco_train_target.pkl',
                 'TEST_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './mscoco/txt/coco_test_image_id.txt',
                 'TRAIN_ATT_FEATS': './mscoco/feature/up_down_100',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './mscoco/txt/coco_train_image_id.txt',
                 'VAL_ATT_FEATS': './mscoco/feature/up_down_100',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './mscoco/txt/coco_val_image_id.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 3,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './mscoco/misc/captions_test5k.json',
               'VAL_ANNFILE': './mscoco/misc/captions_val5k.json',
               'VOCAB': './mscoco/txt/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.0,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'CrossEntropy'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': './experiments/xlan',
 'SCORER': {'CIDER_CACHED': './mscoco/misc/coco_train_cider.pkl',
            'GT_PATH': './mscoco/misc/coco_train_gts.pkl',
            'TYPES': ['CIDEr'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 0.0005,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'TYPE': 'Noam',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 36},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.5,
                                  'START': 6}}}
[INFO: 2020-10-15 10:20:45,065] Setting up dataset ...
[INFO: 2020-10-15 10:20:46,067] Finish setting up dataset ...
[INFO: 2020-10-15 10:20:58,438] Iteration 0 (DataTime/BatchTime: 0.591/1.42) losses = 9.1753, lr = [6.25e-08]
[INFO: 2020-10-15 10:20:58,439]   CrossEntropy Loss = 9.175334930419922
[INFO: 2020-10-15 10:21:02,730] Iteration 20 (DataTime/BatchTime: 0.000257/0.215) losses = 9.1838, lr = [6.875e-07]
[INFO: 2020-10-15 10:21:02,731]   CrossEntropy Loss = 9.183382987976074
[INFO: 2020-10-15 10:21:06,951] Iteration 40 (DataTime/BatchTime: 0.000172/0.211) losses = 9.1609, lr = [1.3125e-06]
[INFO: 2020-10-15 10:21:06,951]   CrossEntropy Loss = 9.138938903808594
[INFO: 2020-10-15 10:21:11,580] Iteration 60 (DataTime/BatchTime: 0.000189/0.231) losses = 9.119, lr = [1.9375e-06]
[INFO: 2020-10-15 10:21:11,580]   CrossEntropy Loss = 9.089426040649414
[INFO: 2020-10-15 10:21:16,107] Iteration 80 (DataTime/BatchTime: 0.0002/0.226) losses = 9.0532, lr = [2.5625e-06]
[INFO: 2020-10-15 10:21:16,107]   CrossEntropy Loss = 9.029867172241211
[INFO: 2020-10-15 10:21:20,494] Iteration 100 (DataTime/BatchTime: 0.00024/0.219) losses = 8.9527, lr = [3.1875e-06]
[INFO: 2020-10-15 10:21:20,494]   CrossEntropy Loss = 8.914053916931152
[INFO: 2020-10-15 10:21:25,063] Iteration 120 (DataTime/BatchTime: 0.00022/0.228) losses = 8.7938, lr = [3.8125e-06]
[INFO: 2020-10-15 10:21:25,063]   CrossEntropy Loss = 8.67493724822998
[INFO: 2020-10-15 10:21:29,385] Iteration 140 (DataTime/BatchTime: 0.000394/0.216) losses = 8.5945, lr = [4.4374999999999994e-06]
[INFO: 2020-10-15 10:21:29,385]   CrossEntropy Loss = 8.479341506958008
[INFO: 2020-10-15 10:21:33,641] Iteration 160 (DataTime/BatchTime: 0.000397/0.213) losses = 8.3102, lr = [5.062499999999999e-06]
[INFO: 2020-10-15 10:21:33,641]   CrossEntropy Loss = 8.008025169372559
[INFO: 2020-10-15 10:21:38,205] Iteration 180 (DataTime/BatchTime: 0.000476/0.228) losses = 7.9749, lr = [5.687499999999999e-06]
[INFO: 2020-10-15 10:21:38,206]   CrossEntropy Loss = 7.837101459503174
[INFO: 2020-10-15 10:21:42,658] Iteration 200 (DataTime/BatchTime: 0.000318/0.223) losses = 7.5362, lr = [6.3125e-06]
[INFO: 2020-10-15 10:21:42,658]   CrossEntropy Loss = 7.28774881362915
[INFO: 2020-10-15 10:21:47,158] Iteration 220 (DataTime/BatchTime: 0.00053/0.225) losses = 7.1811, lr = [6.9375e-06]
[INFO: 2020-10-15 10:21:47,159]   CrossEntropy Loss = 7.001515865325928
[INFO: 2020-10-15 10:21:51,390] Iteration 240 (DataTime/BatchTime: 0.000429/0.212) losses = 6.8507, lr = [7.5625e-06]
[INFO: 2020-10-15 10:21:51,390]   CrossEntropy Loss = 6.768974304199219
[INFO: 2020-10-15 10:21:55,417] Iteration 260 (DataTime/BatchTime: 0.000209/0.201) losses = 6.5499, lr = [8.187499999999999e-06]
[INFO: 2020-10-15 10:21:55,417]   CrossEntropy Loss = 6.3633575439453125
[INFO: 2020-10-15 10:21:59,364] Iteration 280 (DataTime/BatchTime: 0.000166/0.197) losses = 6.3596, lr = [8.812499999999999e-06]
[INFO: 2020-10-15 10:21:59,364]   CrossEntropy Loss = 6.267822265625
[INFO: 2020-10-15 10:22:03,554] Iteration 300 (DataTime/BatchTime: 0.000594/0.21) losses = 6.1431, lr = [9.437499999999999e-06]
[INFO: 2020-10-15 10:22:03,554]   CrossEntropy Loss = 5.993138313293457
[INFO: 2020-10-15 10:22:07,870] Iteration 320 (DataTime/BatchTime: 0.000762/0.216) losses = 6.03, lr = [1.0062499999999999e-05]
[INFO: 2020-10-15 10:22:07,870]   CrossEntropy Loss = 6.074604034423828
[INFO: 2020-10-15 10:22:12,064] Iteration 340 (DataTime/BatchTime: 0.000391/0.21) losses = 5.8876, lr = [1.0687499999999999e-05]
[INFO: 2020-10-15 10:22:12,064]   CrossEntropy Loss = 5.616968631744385
[INFO: 2020-10-15 10:22:16,198] Iteration 360 (DataTime/BatchTime: 0.000376/0.207) losses = 5.7996, lr = [1.1312499999999999e-05]
[INFO: 2020-10-15 10:22:16,198]   CrossEntropy Loss = 5.7053446769714355
[INFO: 2020-10-15 10:22:20,324] Iteration 380 (DataTime/BatchTime: 0.000372/0.206) losses = 5.6569, lr = [1.1937499999999999e-05]
[INFO: 2020-10-15 10:22:20,324]   CrossEntropy Loss = 5.783157825469971
[INFO: 2020-10-15 10:22:24,557] Iteration 400 (DataTime/BatchTime: 0.000563/0.212) losses = 5.586, lr = [1.2562499999999999e-05]
[INFO: 2020-10-15 10:22:24,557]   CrossEntropy Loss = 5.787149429321289
[INFO: 2020-10-15 10:22:29,592] Iteration 420 (DataTime/BatchTime: 0.000584/0.252) losses = 5.5067, lr = [1.3187499999999999e-05]
[INFO: 2020-10-15 10:22:29,593]   CrossEntropy Loss = 5.428131580352783
[INFO: 2020-10-15 10:22:35,072] Iteration 440 (DataTime/BatchTime: 0.000396/0.274) losses = 5.4288, lr = [1.3812499999999999e-05]
[INFO: 2020-10-15 10:22:35,072]   CrossEntropy Loss = 5.468392848968506
[INFO: 2020-10-15 10:22:40,291] Iteration 460 (DataTime/BatchTime: 0.00034/0.261) losses = 5.3614, lr = [1.4437499999999999e-05]
[INFO: 2020-10-15 10:22:40,291]   CrossEntropy Loss = 5.287857532501221
[INFO: 2020-10-15 10:22:45,005] Iteration 480 (DataTime/BatchTime: 0.000675/0.236) losses = 5.2844, lr = [1.5062499999999999e-05]
[INFO: 2020-10-15 10:22:45,005]   CrossEntropy Loss = 5.3808417320251465
[INFO: 2020-10-15 10:22:49,905] Iteration 500 (DataTime/BatchTime: 0.000494/0.245) losses = 5.2995, lr = [1.56875e-05]
[INFO: 2020-10-15 10:22:49,906]   CrossEntropy Loss = 5.213744163513184
[INFO: 2020-10-15 10:22:55,099] Iteration 520 (DataTime/BatchTime: 0.000283/0.26) losses = 5.2024, lr = [1.63125e-05]
[INFO: 2020-10-15 10:22:55,099]   CrossEntropy Loss = 5.2278971672058105
